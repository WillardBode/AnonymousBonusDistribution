import{r as e,a as t}from"./vendor-VIAh7PwP.js";import{B as i,f as n,C as s,i as a,p as r,t as o}from"./ethers-BuRceqJ5.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const i of e)if("childList"===i.type)for(const e of i.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var c={exports:{}},l={},u=e,d=Symbol.for("react.element"),h=Symbol.for("react.fragment"),m=Object.prototype.hasOwnProperty,b=u.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,g={key:!0,ref:!0,__self:!0,__source:!0};function p(e,t,i){var n,s={},a=null,r=null;for(n in void 0!==i&&(a=""+i),void 0!==t.key&&(a=""+t.key),void 0!==t.ref&&(r=t.ref),t)m.call(t,n)&&!g.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===s[n]&&(s[n]=t[n]);return{$$typeof:d,type:e,key:a,ref:r,props:s,_owner:b.current}}l.Fragment=h,l.jsx=p,l.jsxs=p,c.exports=l;var x,f=c.exports,j=t;x=j.createRoot,j.hydrateRoot;const y="0xeC6881Fd6E8818Ec543579B95445eBC7050aF677",w=["function createDistribution(string memory name, address[] memory recipients, uint256[] memory amounts) external payable","function getDistribution(uint256 distributionId) external view returns (tuple(string name, address creator, address[] recipients, uint256[] amounts, uint256 totalAmount, uint256 timestamp, bool executed))","function getDistributionCount() external view returns (uint256)","function getUserDistributions(address user) external view returns (uint256[])","function executeDistribution(uint256 distributionId) external","event DistributionCreated(uint256 indexed distributionId, string name, address indexed creator, uint256 totalAmount)","event DistributionExecuted(uint256 indexed distributionId)"],v={quarterly:{title:"Q4 Performance Bonus",budget:"10.0",duration:"30"},annual:{title:"Annual Achievement Award",budget:"25.0",duration:"45"},project:{title:"Project Completion Bonus",budget:"5.0",duration:"14"},holiday:{title:"Holiday Season Bonus",budget:"15.0",duration:"21"}},C={senior:{amount:"0.5",title:"Senior Developer"},mid:{amount:"0.3",title:"Mid-Level Developer"},junior:{amount:"0.2",title:"Junior Developer"},manager:{amount:"0.8",title:"Team Lead"}},N={senior:"0xeC6881Fd6E8818Ec543579B95445eBC7050aF677",mid:"0xeC6881Fd6E8818Ec543579B95445eBC7050aF677",junior:"0xeC6881Fd6E8818Ec543579B95445eBC7050aF677",manager:"0xeC6881Fd6E8818Ec543579B95445eBC7050aF677"},I="0xaa36a7",D={chainId:I,chainName:"Sepolia Test Network",rpcUrls:["https://sepolia.infura.io/v3/","https://ethereum-sepolia.publicnode.com"],nativeCurrency:{name:"ETH",symbol:"ETH",decimals:18},blockExplorerUrls:["https://sepolia.etherscan.io/"]};function A(e){return`${e.slice(0,6)}...${e.slice(-4)}`}function k(e,t){switch(t){case"number":return!isNaN(Number(e))&&Number(e)>0;case"address":return function(e){try{return a(e)}catch{return!1}}(e);case"string":return e.trim().length>0;default:return!1}}const E=({state:e,children:t})=>f.jsx("div",{className:"container",children:f.jsxs("div",{className:"terminal-box",children:[f.jsxs("div",{className:"header",children:[f.jsxs("div",{className:"logo-section",children:[f.jsx("div",{className:"logo",children:"🔐"}),f.jsx("h1",{className:"title",children:"Anonymous Bonus Distribution"}),f.jsx("h2",{className:"subtitle",children:"Team Incentive Privacy System"})]}),f.jsxs("div",{className:"blockchain-info",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"LIVE ON SEPOLIA"})," - Encrypted bonus distribution active!"]}),f.jsxs("p",{children:["Contract: ",f.jsx("span",{className:"highlight",children:A(y)})]})]})]}),e.userAccount&&f.jsxs("div",{className:"user-info",children:[f.jsxs("p",{children:["> Connected: ",f.jsx("span",{className:"highlight",children:A(e.userAccount)})]}),f.jsxs("p",{children:["> Role: ",f.jsx("span",{className:"highlight",children:e.isManager?"👑 Manager":"👤 Employee"})]}),f.jsxs("p",{children:["> Current Distribution: ",f.jsxs("span",{className:"highlight",children:["#",e.currentDistributionId]})]})]}),e.distributionInfo&&f.jsxs("div",{className:"distribution-info",children:[f.jsxs("h3",{children:['> Current Distribution: "',e.distributionInfo.title,'"']}),f.jsxs("p",{children:["> Total Budget: ",f.jsxs("span",{className:"highlight",children:[Number(e.distributionInfo.totalBudget)/1e18," ETH"]})]}),f.jsxs("p",{children:["> Status: ",f.jsx("span",{className:"highlight",children:e.distributionInfo.isActive?"🟢 Active":e.distributionInfo.isFinalized?"✅ Finalized":"⏸️ Inactive"})]}),f.jsxs("p",{children:["> Recipients: ",f.jsx("span",{className:"highlight",children:Number(e.distributionInfo.recipientCount)})]}),f.jsxs("p",{children:["> Deadline: ",f.jsx("span",{className:"highlight",children:new Date(1e3*Number(e.distributionInfo.deadline)).toLocaleDateString()})]}),e.bonusStatus&&f.jsx("div",{className:"bonus-status",children:f.jsxs("p",{children:["> Your Bonus Status:",e.bonusStatus.hasBonus?e.bonusStatus.hasClaimed?f.jsx("span",{className:"highlight",children:" ✅ Claimed"}):f.jsx("span",{className:"highlight",children:" 💰 Available to Claim"}):f.jsx("span",{className:"highlight",children:" ⏳ Not Allocated"})]})})]}),f.jsxs("div",{className:"terminal-text",children:[f.jsx("p",{children:"🌟 Welcome to Anonymous Bonus Distribution System"}),f.jsx("p",{children:"⚡ Powered by Zama's Fully Homomorphic Encryption (FHE)"}),f.jsx("p",{children:"🔒 All bonus amounts are encrypted on-chain"}),f.jsx("p",{children:"👁️ Only recipients can see their bonus amounts"}),f.jsx("p",{children:"🎯 Managers can allocate bonuses without revealing amounts to others"}),f.jsx("p",{children:"🏆 Perfect for confidential team incentive programs"})]}),f.jsx("div",{className:`message-box ${e.message.type}`,children:f.jsxs("p",{children:["> ",e.message.text]})}),f.jsx("div",{className:"main-content",children:t}),f.jsx("div",{className:"footer",children:f.jsx("p",{children:"🔒 Secure • 🕶️ Private • 🌐 Transparent • ⚡ Built with Zama FHE"})})]})}),L=({connectWallet:e,isLoading:t})=>f.jsx("div",{className:"wallet-section",children:f.jsx("button",{className:"button wallet-button "+(t?"loading":""),onClick:e,disabled:t,children:t?"Connecting...":"Connect Wallet"})}),S=({state:t,updateContractInfo:i,setMessage:n,setLoading:s})=>{const[a,c]=e.useState({distributionTitle:"",totalBudget:"",duration:"",selectedDistributionId:"",recipientAddress:"",bonusAmount:"",finalizeDistributionId:""}),l=(e,t)=>{c(i=>({...i,[e]:t}))};return t.isManager?f.jsxs("div",{className:"manager-section",children:[f.jsx("h3",{children:"> Manager Actions"}),f.jsxs("div",{className:"quick-templates",children:[f.jsx("h4",{children:"Quick Templates"}),f.jsx("div",{className:"template-buttons",children:Object.entries(v).map(([e,i])=>f.jsx("button",{className:"button template-btn",onClick:()=>(e=>{const t=v[e];t&&(c(e=>({...e,distributionTitle:t.title,totalBudget:t.budget,duration:t.duration})),n(`Template "${t.title}" applied`,"success"))})(e),disabled:t.isLoading,children:i.title},e))})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("h4",{children:"Create New Distribution"}),f.jsx("input",{className:"input-box",type:"text",placeholder:"Distribution title",value:a.distributionTitle,onChange:e=>l("distributionTitle",e.target.value),disabled:t.isLoading}),f.jsx("input",{className:"input-box",type:"number",placeholder:"Total budget (ETH)",step:"0.01",value:a.totalBudget,onChange:e=>l("totalBudget",e.target.value),disabled:t.isLoading}),f.jsx("input",{className:"input-box",type:"number",placeholder:"Duration (days)",min:"1",max:"365",value:a.duration,onChange:e=>l("duration",e.target.value),disabled:t.isLoading}),f.jsx("button",{className:"button create-button",onClick:async()=>{if(!t.contract||t.isLoading)return;const{distributionTitle:e,totalBudget:s,duration:o}=a;if(!k(e,"string")||!k(s,"number")||!k(o,"number"))return void n("Please fill all fields with valid values!","error");await t.executeTransaction("createDistribution",[e,r(s),parseInt(o)],`Creating distribution "${e}"`)&&(c(e=>({...e,distributionTitle:"",totalBudget:"",duration:""})),await i())},disabled:t.isLoading||!a.distributionTitle||!a.totalBudget||!a.duration,children:t.isLoading?"Creating...":"Create Distribution"})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("h4",{children:"Allocate Encrypted Bonus"}),f.jsxs("select",{className:"input-box",value:a.selectedDistributionId,onChange:e=>l("selectedDistributionId",e.target.value),disabled:t.isLoading,children:[f.jsx("option",{value:"",children:"Select Distribution"}),t.currentDistributionId>0&&f.jsxs("option",{value:t.currentDistributionId,children:["Distribution #",t.currentDistributionId]})]}),f.jsxs("div",{className:"employee-presets",children:[f.jsx("h5",{children:"Employee Presets"}),f.jsx("div",{className:"preset-buttons",children:Object.entries(C).map(([e,i])=>f.jsxs("button",{className:"button preset-btn",onClick:()=>(e=>{const t=C[e],i=N[e];t&&(c(e=>({...e,bonusAmount:t.amount,recipientAddress:i||e.recipientAddress})),n(`Preset for ${t.title} applied (${t.amount} ETH)`,"success"))})(e),disabled:t.isLoading,children:[i.title," (",i.amount," ETH)"]},e))})]}),f.jsx("input",{className:"input-box",type:"text",placeholder:"Employee wallet address",value:a.recipientAddress,onChange:e=>l("recipientAddress",e.target.value),disabled:t.isLoading}),f.jsx("input",{className:"input-box",type:"number",placeholder:"Bonus amount (ETH)",step:"0.01",value:a.bonusAmount,onChange:e=>l("bonusAmount",e.target.value),disabled:t.isLoading}),f.jsx("button",{className:"button allocate-button",onClick:async()=>{if(!t.contract||t.isLoading)return;const{selectedDistributionId:e,recipientAddress:s,bonusAmount:l}=a;if(!k(e,"number")||!k(s,"address")||!k(l,"number"))return void n("Please fill all fields with valid values!","error");const u=r(l),d=o(u,32);await t.executeTransaction("allocateBonus",[parseInt(e),s,d,"0x"],`Allocating encrypted bonus of ${l} ETH to ${s.slice(0,6)}...${s.slice(-4)}`)&&(c(e=>({...e,recipientAddress:"",bonusAmount:""})),await i())},disabled:t.isLoading||!a.selectedDistributionId||!a.recipientAddress||!a.bonusAmount,children:t.isLoading?"Allocating...":"Allocate Encrypted Bonus"})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("h4",{children:"Finalize Distribution"}),f.jsxs("select",{className:"input-box",value:a.finalizeDistributionId,onChange:e=>l("finalizeDistributionId",e.target.value),disabled:t.isLoading,children:[f.jsx("option",{value:"",children:"Select Distribution to Finalize"}),t.currentDistributionId>0&&f.jsxs("option",{value:t.currentDistributionId,children:["Distribution #",t.currentDistributionId]})]}),f.jsx("button",{className:"button finalize-button",onClick:async()=>{if(!t.contract||t.isLoading)return;const{finalizeDistributionId:e}=a;if(!k(e,"number"))return void n("Please select a distribution!","error");await t.executeTransaction("finalizeDistribution",[parseInt(e)],`Finalizing distribution #${e}`)&&await i()},disabled:t.isLoading||!a.finalizeDistributionId,children:t.isLoading?"Finalizing...":"Finalize Distribution"})]})]}):null},M=({state:t,updateContractInfo:i,setMessage:n,setLoading:s})=>{const[a,r]=e.useState(""),o=t.bonusStatus?.hasBonus&&!t.bonusStatus?.hasClaimed,c=t.bonusStatus?.hasBonus;return f.jsxs("div",{className:"employee-section",children:[f.jsx("h3",{children:"> Employee Actions"}),o&&f.jsxs("div",{className:"form-group",children:[f.jsx("h4",{children:"Claim Your Bonus"}),f.jsxs("select",{className:"input-box",value:a,onChange:e=>r(e.target.value),disabled:t.isLoading,children:[f.jsx("option",{value:"",children:"Select Distribution"}),t.currentDistributionId>0&&f.jsxs("option",{value:t.currentDistributionId,children:["Distribution #",t.currentDistributionId]})]}),f.jsx("button",{className:"button claim-button",onClick:async()=>{if(!t.contract||t.isLoading)return;const e=a||t.currentDistributionId.toString();if(!k(e,"number"))return void n("Please select a distribution!","error");await t.executeTransaction("claimBonus",[parseInt(e)],`Claiming your bonus from distribution #${e}`)&&await i()},disabled:t.isLoading,children:t.isLoading?"Claiming...":"Claim My Bonus 💰"})]}),!c&&t.userAccount&&f.jsxs("div",{className:"no-bonus-message",children:[f.jsx("p",{children:"> No bonus allocated to your address in current distribution"}),f.jsx("p",{children:"> Please contact your manager if you believe this is an error"})]}),t.bonusStatus?.hasClaimed&&f.jsxs("div",{className:"claimed-message",children:[f.jsx("p",{children:"> ✅ You have successfully claimed your bonus!"}),f.jsx("p",{children:"> Thank you for your contribution to the team"})]})]})};function B(){const t=(()=>{const[t,n]=e.useState({userAccount:null,contract:null,isManager:!1,currentDistributionId:0,isLoading:!1,distributionInfo:null,bonusStatus:null,message:{text:"Connect MetaMask to access Anonymous Bonus Distribution!",type:"info"}}),[a,r]=e.useState(null),[o,c]=e.useState(null),l=e.useCallback((e,t="info")=>{n(i=>({...i,message:{text:e,type:t}})),"success"===t&&setTimeout(()=>{n(e=>({...e,message:{text:"Ready for next action",type:"info"}}))},5e3)},[]),u=e.useCallback(e=>{n(t=>({...t,isLoading:e}))},[]),d=e.useCallback(()=>!(!window.ethereum||!window.ethereum.isMetaMask)||(l("MetaMask is required! Please install MetaMask browser extension.","error"),!1),[l]),h=e.useCallback(async()=>{try{if(await window.ethereum.request({method:"eth_chainId"})!==I){l("Switching to Sepolia testnet...","info");try{await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:I}]})}catch(e){if(4902!==e.code)throw e;l("Adding Sepolia network to MetaMask...","info"),await window.ethereum.request({method:"wallet_addEthereumChain",params:[D]})}}return!0}catch(t){return l("Failed to switch to Sepolia network. Please switch manually in MetaMask.","error"),!1}},[l]),m=e.useCallback(async()=>{try{if(!d())return;if(u(!0),l("Connecting to MetaMask..."),0===(await window.ethereum.request({method:"eth_requestAccounts"})).length)return void l("No accounts found. Please create an account in MetaMask.","error");if(!(await h()))return;const t=new i(window.ethereum),a=await t.getSigner(),o=await a.getAddress();0n===await t.getBalance(o)&&l("Your account has no Sepolia ETH. Please get test ETH from a faucet.","warning");const m=new s(y,w,a);try{await m.getDistributionCount()}catch(e){return void l("Contract not found. Please check if it's deployed on Sepolia.","error")}r(t),c(a),n(e=>({...e,userAccount:o,contract:m})),l("Successfully connected to MetaMask and Sepolia! 🔐","success")}catch(e){4001===e.code?l("Connection rejected by user. Please try again.","warning"):-32002===e.code?l("MetaMask is already processing a request. Please check MetaMask.","warning"):l("Failed to connect to MetaMask. Please try again.","error")}finally{u(!1)}},[d,h,l,u]),b=e.useCallback(async(e,i,n)=>{if(!t.contract||!o)return l("Please connect your wallet first","error"),null;try{u(!0),l(`Preparing ${n}...`);const s=120n*await t.contract[e].estimateGas(...i)/100n;l(`Please confirm the transaction in MetaMask for: ${n}`);const a=await t.contract[e](...i,{gasLimit:s});l(`Transaction submitted! Hash: ${a.hash.slice(0,10)}...`),l("Waiting for transaction confirmation...");const r=await a.wait();return 1===r.status?(l(`${n} completed successfully! 🎉`,"success"),r):(l(`${n} failed. Please try again.`,"error"),null)}catch(s){return 4001===s.code?l("Transaction rejected by user","warning"):-32603===s.code?l("Transaction failed. Please check your balance and try again.","error"):s.message?.includes("insufficient funds")?l("Insufficient Sepolia ETH for gas fees. Please get test ETH from a faucet.","error"):s.message?.includes("user rejected")?l("Transaction cancelled by user","warning"):l(`Transaction failed: ${s.message||"Unknown error"}`,"error"),null}finally{u(!1)}},[t.contract,o,l,u]),g=e.useCallback(async()=>{if(t.contract&&t.userAccount)try{const e=Number(await t.contract.getDistributionCount()),i=(await t.contract.getUserDistributions(t.userAccount)).length>0;if(n(t=>({...t,currentDistributionId:e,isManager:i})),e>0){const i=await t.contract.getDistribution(e),s={title:i.name,totalBudget:i.totalAmount,isActive:!i.executed,isFinalized:i.executed,createdAt:i.timestamp,deadline:0n,recipientCount:BigInt(i.recipients.length)},a=i.recipients.includes(t.userAccount),r={hasBonus:a,hasClaimed:i.executed&&a,timestamp:i.timestamp};n(e=>({...e,distributionInfo:s,bonusStatus:r}))}}catch(e){l("Failed to load contract information","error")}},[t.contract,t.userAccount,l]),p=e.useCallback(e=>{0===e.length?(n(e=>({...e,userAccount:null,contract:null,isManager:!1,distributionInfo:null,bonusStatus:null})),r(null),c(null),l("Wallet disconnected","warning")):e[0]!==t.userAccount&&window.location.reload()},[t.userAccount,l]),x=e.useCallback(e=>{e!==I?(l("Please switch back to Sepolia testnet","warning"),n(e=>({...e,contract:null,distributionInfo:null,bonusStatus:null}))):window.location.reload()},[l]);return e.useEffect(()=>{if(window.ethereum)return window.ethereum.on("accountsChanged",p),window.ethereum.on("chainChanged",x),()=>{window.ethereum?.removeListener("accountsChanged",p),window.ethereum?.removeListener("chainChanged",x)}},[p,x]),e.useEffect(()=>{t.contract&&t.userAccount&&g()},[t.contract,t.userAccount,g]),e.useEffect(()=>{(async()=>{if(window.ethereum)try{(await window.ethereum.request({method:"eth_accounts"})).length>0&&m()}catch(e){}})()},[m]),{...t,provider:a,signer:o,connectWallet:m,executeTransaction:b,updateContractInfo:g,setMessage:l,setLoading:u,isMetaMaskInstalled:d()}})();return f.jsx(E,{state:t,children:t.userAccount?f.jsxs(f.Fragment,{children:[f.jsx(S,{state:t,updateContractInfo:t.updateContractInfo,setMessage:t.setMessage,setLoading:t.setLoading}),f.jsx(M,{state:t,updateContractInfo:t.updateContractInfo,setMessage:t.setMessage,setLoading:t.setLoading})]}):f.jsx(L,{connectWallet:t.connectWallet,isLoading:t.isLoading})})}x(document.getElementById("root")).render(f.jsx(e.StrictMode,{children:f.jsx(B,{})}));
