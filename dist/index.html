<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anonymous Bonus Distribution - Team Incentive Privacy System</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <i class="fas fa-shield-alt"></i>
                <span>Privacy Incentive System</span>
            </div>
            <div class="nav-menu">
                <a href="#dashboard" class="nav-link active" onclick="navigateToPage('dashboard')">
                    <i class="fas fa-chart-line"></i>
                    Dashboard
                </a>
                <a href="#distribute" class="nav-link" onclick="navigateToPage('distribute')">
                    <i class="fas fa-coins"></i>
                    Distribute Bonus
                </a>
                <a href="#analytics" class="nav-link" onclick="navigateToPage('analytics')">
                    <i class="fas fa-analytics"></i>
                    Analytics
                </a>
                <a href="#settings" class="nav-link" onclick="navigateToPage('settings')">
                    <i class="fas fa-cog"></i>
                    Settings
                </a>
            </div>
            <div class="wallet-section">
                <button id="connectWallet" class="wallet-btn" onclick="connectWallet()">
                    <i class="fas fa-wallet"></i>
                    Connect Wallet
                </button>
                <div id="walletInfo" class="wallet-info" style="display: none;">
                    <div class="wallet-address"></div>
                    <div class="wallet-balance"></div>
                </div>
            </div>
        </div>
    </nav>

    <main class="main-content">
        <!-- 仪表板页面 -->
        <section id="dashboard-page" class="page active">
            <div class="page-header">
                <h1>
                    <i class="fas fa-chart-line"></i>
                    Team Incentive Dashboard
                </h1>
                <p>Privacy-protected anonymous bonus distribution system</p>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-coins"></i>
                    </div>
                    <div class="stat-content">
                        <h3>Total Pool</h3>
                        <div class="stat-value" id="totalPool">Loading...</div>
                        <div class="stat-change positive">+12.5%</div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-content">
                        <h3>Active Members</h3>
                        <div class="stat-value" id="activeMembers">Loading...</div>
                        <div class="stat-change positive">+8 this month</div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-gift"></i>
                    </div>
                    <div class="stat-content">
                        <h3>Distributed Bonus</h3>
                        <div class="stat-value" id="distributed">Loading...</div>
                        <div class="stat-change positive">+5.3%</div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-shield-check"></i>
                    </div>
                    <div class="stat-content">
                        <h3>Privacy Level</h3>
                        <div class="stat-value">100%</div>
                        <div class="stat-change">Fully Anonymous</div>
                    </div>
                </div>
            </div>

            <div class="dashboard-grid">
                <div class="card recent-distributions">
                    <div class="card-header">
                        <h3>
                            <i class="fas fa-history"></i>
                            Recent Distributions
                        </h3>
                        <button class="btn-secondary" onclick="refreshDistributions()">
                            <i class="fas fa-sync"></i>
                            Refresh
                        </button>
                    </div>
                    <div class="card-content">
                        <div class="distribution-list" id="distributionList">
                            <!-- 动态加载 -->
                        </div>
                    </div>
                </div>

                <div class="card performance-chart">
                    <div class="card-header">
                        <h3>
                            <i class="fas fa-chart-area"></i>
                            Bonus Distribution Trends
                        </h3>
                    </div>
                    <div class="card-content">
                        <canvas id="performanceChart"></canvas>
                    </div>
                </div>

                <div class="card privacy-metrics">
                    <div class="card-header">
                        <h3>
                            <i class="fas fa-user-secret"></i>
                            Privacy Protection Metrics
                        </h3>
                    </div>
                    <div class="card-content">
                        <div class="privacy-indicator">
                            <div class="privacy-item">
                                <span>Identity Anonymization</span>
                                <div class="privacy-status active">
                                    <i class="fas fa-check"></i>
                                    Enabled
                                </div>
                            </div>
                            <div class="privacy-item">
                                <span>Amount Encryption</span>
                                <div class="privacy-status active">
                                    <i class="fas fa-check"></i>
                                    Enabled
                                </div>
                            </div>
                            <div class="privacy-item">
                                <span>Zero Knowledge Proof</span>
                                <div class="privacy-status active">
                                    <i class="fas fa-check"></i>
                                    Enabled
                                </div>
                            </div>
                            <div class="privacy-item">
                                <span>Time Obfuscation</span>
                                <div class="privacy-status active">
                                    <i class="fas fa-check"></i>
                                    Enabled
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 奖金分配页面 -->
        <section id="distribute-page" class="page">
            <div class="page-header">
                <h1>
                    <i class="fas fa-coins"></i>
                    Anonymous Bonus Distribution
                </h1>
                <p>Secure and private team incentive distribution system</p>
            </div>

            <div class="distribute-container">
                <div class="card distribute-form">
                    <div class="card-header">
                        <h3>
                            <i class="fas fa-plus-circle"></i>
                            Create Distribution Plan
                        </h3>
                    </div>
                    <div class="card-content">
                        <form id="distributionForm">
                            <div class="form-group">
                                <label for="distributionName">Distribution Plan Name</label>
                                <input type="text" id="distributionName" placeholder="e.g., Q3 Performance Bonus" required>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="totalAmount">Total Amount (ETH)</label>
                                    <input type="number" id="totalAmount" step="0.01" placeholder="0.00" required>
                                </div>
                                <div class="form-group">
                                    <label for="recipientCount">Number of Recipients</label>
                                    <input type="number" id="recipientCount" min="1" placeholder="5" required onchange="updateRecipientInputs()">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="distributionMethod">Distribution Method</label>
                                <select id="distributionMethod" required onchange="updateDistributionMethod()">
                                    <option value="">Please select distribution method</option>
                                    <option value="equal">Equal Distribution</option>
                                    <option value="weighted">Weighted Distribution</option>
                                    <option value="performance">Performance-based</option>
                                    <option value="custom">Custom Distribution</option>
                                </select>
                            </div>

                            <div id="recipientsList" class="recipients-list">
                                <h4>Recipient Addresses (Anonymous)</h4>
                                <div class="recipient-inputs" id="recipientInputs">
                                    <!-- Dynamically generated -->
                                </div>
                            </div>

                            <div class="privacy-options">
                                <h4>Privacy Settings</h4>
                                <div class="privacy-toggles">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="anonymizeAmounts" checked>
                                        <span class="toggle-slider"></span>
                                        <span>Amount Anonymization</span>
                                    </label>
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="delayDistribution" checked>
                                        <span class="toggle-slider"></span>
                                        <span>Delayed Distribution</span>
                                    </label>
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="mixerEnabled" checked>
                                        <span class="toggle-slider"></span>
                                        <span>Mixer Processing</span>
                                    </label>
                                </div>
                            </div>

                            <div class="form-actions">
                                <button type="button" class="btn-secondary" onclick="previewDistribution()">
                                    <i class="fas fa-eye"></i>
                                    Preview Distribution
                                </button>
                                <button type="submit" class="btn-primary">
                                    <i class="fas fa-paper-plane"></i>
                                    Execute Distribution
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <div class="card distribution-preview">
                    <div class="card-header">
                        <h3>
                            <i class="fas fa-list-check"></i>
                            Distribution Preview
                        </h3>
                    </div>
                    <div class="card-content">
                        <div id="previewContent" class="preview-empty">
                            <i class="fas fa-chart-pie"></i>
                            <p>Fill out the form on the left to preview distribution plan</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 数据分析页面 -->
        <section id="analytics-page" class="page">
            <div class="page-header">
                <h1>
                    <i class="fas fa-chart-bar"></i>
                    Data Analytics
                </h1>
                <p>Privacy-protected team incentive data insights</p>
            </div>

            <div class="analytics-container">
                <div class="card analytics-filters">
                    <div class="card-content">
                        <div class="filter-row">
                            <div class="filter-group">
                                <label>Time Range</label>
                                <select id="timeRange">
                                    <option value="7d">Last 7 days</option>
                                    <option value="30d">Last 30 days</option>
                                    <option value="90d">Last 90 days</option>
                                    <option value="1y">Last year</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label>Analysis Dimension</label>
                                <select id="analyticsDimension">
                                    <option value="distribution">Distribution Analysis</option>
                                    <option value="performance">Performance Analysis</option>
                                    <option value="privacy">Privacy Analysis</option>
                                </select>
                            </div>
                            <button class="btn-primary" onclick="updateAnalytics()">
                                <i class="fas fa-sync"></i>
                                Update Data
                            </button>
                        </div>
                    </div>
                </div>

                <div class="analytics-grid">
                    <div class="card chart-card">
                        <div class="card-header">
                            <h3>Distribution Trend Chart</h3>
                        </div>
                        <div class="card-content">
                            <canvas id="trendChart"></canvas>
                        </div>
                    </div>

                    <div class="card chart-card">
                        <div class="card-header">
                            <h3>Distribution Method Statistics</h3>
                        </div>
                        <div class="card-content">
                            <canvas id="methodChart"></canvas>
                        </div>
                    </div>

                    <div class="card metrics-card">
                        <div class="card-header">
                            <h3>Key Metrics</h3>
                        </div>
                        <div class="card-content">
                            <div class="metrics-grid">
                                <div class="metric-item">
                                    <span class="metric-label">Average Distribution Amount</span>
                                    <span class="metric-value">2.5 ETH</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Distribution Frequency</span>
                                    <span class="metric-value">3.2 times/month</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Participation Rate</span>
                                    <span class="metric-value">87.5%</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Privacy Score</span>
                                    <span class="metric-value">9.8/10</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 系统设置页面 -->
        <section id="settings-page" class="page">
            <div class="page-header">
                <h1>
                    <i class="fas fa-cog"></i>
                    System Settings
                </h1>
                <p>Configure privacy protection and system parameters</p>
            </div>

            <div class="settings-container">
                <div class="card settings-card">
                    <div class="card-header">
                        <h3>
                            <i class="fas fa-shield-alt"></i>
                            Privacy Settings
                        </h3>
                    </div>
                    <div class="card-content">
                        <div class="setting-item">
                            <div class="setting-info">
                                <h4>Default Anonymity Level</h4>
                                <p>Set default privacy protection level for new distributions</p>
                            </div>
                            <select id="defaultPrivacyLevel">
                                <option value="basic">Basic Protection</option>
                                <option value="standard">Standard Protection</option>
                                <option value="high" selected>High Protection</option>
                                <option value="maximum">Maximum Protection</option>
                            </select>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <h4>Auto Mixer</h4>
                                <p>Automatically use mixer service to enhance privacy protection</p>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="autoMixer" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <h4>Delayed Distribution</h4>
                                <p>Set random delay range for distribution execution</p>
                            </div>
                            <select id="delayRange">
                                <option value="1-5">1-5 minutes</option>
                                <option value="5-15">5-15 minutes</option>
                                <option value="15-60" selected>15-60 minutes</option>
                                <option value="1-24">1-24 hours</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="card settings-card">
                    <div class="card-header">
                        <h3>
                            <i class="fas fa-cog"></i>
                            System Parameters
                        </h3>
                    </div>
                    <div class="card-content">
                        <div class="setting-item">
                            <div class="setting-info">
                                <h4>Gas Price Strategy</h4>
                                <p>Select gas price strategy for transactions</p>
                            </div>
                            <select id="gasPriceStrategy">
                                <option value="slow">Slow (Economy)</option>
                                <option value="standard" selected>Standard</option>
                                <option value="fast">Fast</option>
                                <option value="instant">Instant</option>
                            </select>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <h4>Notifications</h4>
                                <p>Enable distribution completion notifications</p>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="notifications" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <h4>Data Retention Period</h4>
                                <p>Set retention time for distribution records</p>
                            </div>
                            <select id="dataRetention">
                                <option value="30">30 days</option>
                                <option value="90" selected>90 days</option>
                                <option value="180">180 days</option>
                                <option value="365">1 year</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="settings-actions">
                    <button class="btn-secondary" onclick="resetSettings()">
                        <i class="fas fa-undo"></i>
                        Reset to Default
                    </button>
                    <button class="btn-primary" onclick="saveSettings()">
                        <i class="fas fa-save"></i>
                        Save Settings
                    </button>
                </div>
            </div>
        </section>
    </main>

    <!-- 模态框 -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Title</h3>
                <span class="close" onclick="closeModal()">&times;</span>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- Dynamic content -->
            </div>
        </div>
    </div>

    <!-- Loading animation -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <p>Processing...</p>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/ethers@5.7.2/dist/ethers.umd.min.js"></script>
    <script src="script.js"></script>
    <script src="simple-wallet.js"></script>
</body>
</html>